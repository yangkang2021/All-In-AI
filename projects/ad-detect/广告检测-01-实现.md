# 广告检测

## 一. 方案调研
广告检测 我有四条路，我准备一一验证：
1. 传统的模板匹配
2. mobilenet：
3. yolo-fastest
4. unet分割

从分类到分割：需要的训练数据逐渐减少，精度会提升。但是计算量增大。

## 二. 选定方案
1. 收集了400张的广告图片数据，并完成标注
2. 基于Yolo-FastestV2训练出广告模型。 FastestDet archorfree改网络才能检测小目标遂弃用。
3. 基于ncnn做部署

## 三. 尝试改进模型
进一步做如下的改进：
1. 深度学习层数的删减
2. 直接用yuv的 y做单通道检测
3. 只取四个角和边上的部分区域：改网络让只做有效区域的卷积 或者 有效区重新组合出一个新图。
4. 后处理的MNS等不需要做

## 三. 尝试提升模型精度
尝试了很多方法不断训练去提升精度：
1. 更换模型：选用基于yolo的anchors机制的模型，增加小目标的识别率。根据训练集样本计算anchors。
2. 扩展数据集：训练集826张，验证集125张。 支持负样本训练。
3. 让模型在不同的分辨率上训练：352x352(1:1)，448x448(1:1)，448x256(16:9)，352x192(16:9)
4. 用yuv数据进行训练：单通道灰度y和三通道yuv训练
5. 用letterbox：保持图像16：9训练
6. 简化主干网络ShuffleNetV2层训练
7. 选择目标只可能出现区域块进行训练。

## 四. 效果
- 我的模型跑单路：
- 精度：90%，查全率：90%
- ncnn-cpu:7ms
- ncnn_vulkan:4ms
- openvino：2ms
- tensorrt：1ms
- 反正ncnn+openvino+tensorrt做一个全覆盖。
